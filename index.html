<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Urna Eletr√¥nica RPG</title>

<style>
:root{
    --verde:#0b3d2e;
    --amarelo:#f4c430;
    --branco:#ffffff;
    --preto:#111;
}
body{
    margin:0;
    font-family:Arial, Helvetica, sans-serif;
    background:var(--branco);
    color:var(--preto);
}
.hidden{display:none;}

button{
    cursor:pointer;
    border:none;
    padding:12px 18px;
    font-weight:bold;
    border-radius:6px;
}

.center{
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    height:100vh;
    text-align:center;
}

.big-btn{
    background:var(--verde);
    color:white;
    font-size:28px;
    width:260px;
    margin-bottom:20px;
}

.small-btn{
    background:var(--amarelo);
    margin:5px;
}

header{
    background:var(--verde);
    color:white;
    padding:10px;
    text-align:center;
}

.urna-container{
    display:flex;
    justify-content:center;
    align-items:center;
    gap:30px;
    padding:20px;
    flex-wrap:wrap;
}

.urna-tela{
    width:340px;
    height:420px;
    border:3px solid #ccc;
    background:#f9f9f9;
    padding:15px;
    display:flex;
    flex-direction:column;
    justify-content:space-between;
}

.numero-display{
    font-size:32px;
    letter-spacing:10px;
    background:#000;
    color:#0f0;
    padding:10px;
    text-align:center;
}

.teclado{
    display:grid;
    grid-template-columns:repeat(3,70px);
    gap:10px;
}

.teclado button{
    background:#ddd;
    font-size:20px;
    height:60px;
    box-shadow:2px 2px 4px rgba(0,0,0,0.4);
}

.teclado button:active{
    transform:scale(0.95);
}

.btn-branco{background:#fff;border:1px solid #000;}
.btn-corrige{background:orange;}
.btn-confirma{background:green;color:white;}

.admin-panel, .cadastro{
    padding:20px;
    max-width:600px;
    margin:auto;
}

input, select{
    width:100%;
    padding:8px;
    margin:5px 0;
}

@media(max-width:768px){
    .urna-container{
        flex-direction:column;
    }
}
</style>
</head>

<body>

<!-- HOME -->
<div id="home" class="center">
    <button class="big-btn" onclick="abrirCadastro()">VOTAR</button>
    <button class="small-btn" onclick="abrirLogin()">Entrar</button>
    <button class="small-btn" onclick="abrirCadastro()">Cadastrar</button>
    <button class="small-btn" onclick="trocarPersonagem()">Troquei de Personagem</button>
    <button class="small-btn hidden" id="btnApuracao" onclick="abrirApuracao()">üîé Acompanhar Apura√ß√£o</button>
</div>

<!-- CADASTRO -->
<div id="cadastro" class="hidden cadastro">
<h2>Cadastro do Eleitor</h2>
<input type="text" id="usuario" placeholder="Nome de Usu√°rio">
<input type="text" id="nomeCompleto" placeholder="Nome Completo">
<input type="text" id="discord" placeholder="Usu√°rio do Discord">
<input type="password" id="senha" placeholder="Senha">
<select id="estado">
<option value="">Selecione o Estado</option>
<option>Rio Grande do Sul</option>
<option>Pernambuco</option>
<option>S√£o Paulo</option>
<option>Goi√°s</option>
<option>Amazonas</option>
</select>
<button onclick="registrar()">Registrar</button>
</div>

<!-- URNA -->
<div id="urna" class="hidden">
<header>URNA ELETR√îNICA RPG</header>
<div class="urna-container">

<div class="urna-tela">
<div id="cargo">DEPUTADO</div>
<div class="numero-display" id="numeroDisplay"></div>
<div id="infoCandidato"></div>
</div>

<div>
<div class="teclado">
<button onclick="digitar(1)">1</button>
<button onclick="digitar(2)">2</button>
<button onclick="digitar(3)">3</button>
<button onclick="digitar(4)">4</button>
<button onclick="digitar(5)">5</button>
<button onclick="digitar(6)">6</button>
<button onclick="digitar(7)">7</button>
<button onclick="digitar(8)">8</button>
<button onclick="digitar(9)">9</button>
<div></div>
<button onclick="digitar(0)">0</button>
<div></div>
</div>
<br>
<button class="btn-branco" onclick="votarBranco()">BRANCO</button>
<button class="btn-corrige" onclick="corrigir()">CORRIGE</button>
<button class="btn-confirma" onclick="confirmar()">CONFIRMA</button>
</div>

</div>
</div>

<!-- ADMIN -->
<div id="admin" class="hidden admin-panel">
<h2>Painel do Administrador</h2>
<input type="text" id="adminUser" placeholder="Usu√°rio">
<input type="password" id="adminPass" placeholder="Senha">
<button onclick="loginAdmin()">Entrar</button>
<div id="adminDashboard" class="hidden">
<h3>Status: <span id="statusEleicao">N√£o iniciada</span></h3>
<button onclick="iniciarEleicao()">Iniciar Elei√ß√£o</button>
<button onclick="encerrarEleicao()">Encerrar Elei√ß√£o</button>
</div>
</div>

<!-- APURA√á√ÉO -->
<div id="apuracao" class="hidden admin-panel">
<h2>Apura√ß√£o P√∫blica</h2>
<p id="resultado"></p>
</div>

<script>
let eleitor = null;
let numeroAtual = "";
let etapa = 0;
let cargos = ["DEPUTADO","GOVERNADOR","PRESIDENTE"];
let votos = [];
let statusEleicao = "N√£o iniciada";

function abrirCadastro(){
    document.getElementById("home").classList.add("hidden");
    document.getElementById("cadastro").classList.remove("hidden");
}

function registrar(){
    eleitor = {
        usuario:usuario.value,
        nome:nomeCompleto.value,
        discord:discord.value,
        senha:senha.value,
        estado:estado.value,
        votou:false
    };
    document.getElementById("cadastro").classList.add("hidden");
    abrirUrna();
}

function abrirUrna(){
    document.getElementById("urna").classList.remove("hidden");
    document.getElementById("cargo").innerText = cargos[etapa];
}

function digitar(n){
    numeroAtual += n;
    document.getElementById("numeroDisplay").innerText = numeroAtual;
}

function corrigir(){
    numeroAtual="";
    document.getElementById("numeroDisplay").innerText="";
}

function votarBranco(){
    votos.push({cargo:cargos[etapa], voto:"BRANCO"});
    avancar();
}

function confirmar(){
    if(numeroAtual===""){
        alert("Digite um n√∫mero ou vote em branco");
        return;
    }
    votos.push({cargo:cargos[etapa], voto:numeroAtual});
    avancar();
}

function avancar(){
    numeroAtual="";
    etapa++;
    if(etapa < cargos.length){
        document.getElementById("cargo").innerText = cargos[etapa];
        document.getElementById("numeroDisplay").innerText="";
    } else {
        finalizar();
    }
}

function finalizar(){
    document.getElementById("urna").innerHTML="<h1 style='text-align:center;'>FIM</h1><p style='text-align:center;'>O Tribunal Superior Eleitoral RPG agradece sua participa√ß√£o democr√°tica.</p>";
    eleitor.votou=true;
    document.getElementById("btnApuracao").classList.remove("hidden");
}

function loginAdmin(){
    if(adminUser.value==="12.px.iurna.tse" && adminPass.value==="178920.senha"){
        document.getElementById("adminDashboard").classList.remove("hidden");
    } else {
        alert("Credenciais inv√°lidas");
    }
}

function iniciarEleicao(){
    statusEleicao="Em andamento";
    document.getElementById("statusEleicao").innerText=statusEleicao;
}

function encerrarEleicao(){
    statusEleicao="Encerrada";
    document.getElementById("statusEleicao").innerText=statusEleicao;
}

function abrirApuracao(){
    document.getElementById("home").classList.add("hidden");
    document.getElementById("apuracao").classList.remove("hidden");
    document.getElementById("resultado").innerText=JSON.stringify(votos,null,2);
}

function trocarPersonagem(){
    eleitor=null;
    votos=[];
    alert("Cadastro reiniciado.");
}
</script>

</body>
</html><!-- CONFIGURA√á√ïES VISUAIS ADMIN -->
<div id="configVisual" class="hidden admin-panel">
<h3>Configura√ß√µes Visuais</h3>

<label>Logo Oficial da Elei√ß√£o (URL)</label>
<input type="text" id="logoUrl">

<label>Bras√£o Institucional (URL)</label>
<input type="text" id="brasaoUrl">

<label>Slogan da Elei√ß√£o</label>
<input type="text" id="slogan">

<label>Nome do Ministro Presidente</label>
<input type="text" id="ministro">

<button onclick="salvarConfig()">Salvar Configura√ß√µes</button>
</div>.logo-eleicao, .brasao-eleicao{
    max-width:120px;
    height:auto;
}

.certificado{
    border:3px solid #0b3d2e;
    padding:30px;
    margin:20px;
    background:white;
}

.barra-apuracao{
    width:100%;
    background:#ddd;
    height:25px;
    border-radius:10px;
    overflow:hidden;
}

.barra-interna{
    height:100%;
    background:green;
    width:0%;
    transition:width 1s;
}let config = {
    logo:"",
    brasao:"",
    slogan:"",
    ministro:""
};

function salvarConfig(){
    config.logo = logoUrl.value;
    config.brasao = brasaoUrl.value;
    config.slogan = slogan.value;
    config.ministro = ministro.value;
    alert("Configura√ß√µes salvas!");
}

function finalizar(){
    let colegio = sortearColegio(eleitor.estado);

    document.getElementById("urna").innerHTML = `
    <div style="text-align:center;">
        <img src="${config.logo}" class="logo-eleicao">
        <h1>FIM</h1>
        <img src="${config.brasao}" class="brasao-eleicao">
        <p>O Tribunal Superior Eleitoral RPG agradece sua participa√ß√£o democr√°tica.</p>
        <p><strong>Circunscri√ß√£o:</strong> ${colegio}</p>
        <button onclick="gerarCertificado('${colegio}')">Baixar Certificado</button>
    </div>
    `;

    eleitor.votou=true;
    document.getElementById("btnApuracao").classList.remove("hidden");
}

function gerarCertificado(colegio){
    let data = new Date().toLocaleDateString();

    let conteudo = `
    <div class="certificado">
        <img src="${config.logo}" class="logo-eleicao">
        <h2>CERTIFICADO DE VOTA√á√ÉO</h2>
        <img src="${config.brasao}" class="brasao-eleicao">
        <p>Certificamos que <strong>${eleitor.nome}</strong>, do estado de ${eleitor.estado},
        participou regularmente do Processo Eleitoral Oficial RPG na circunscri√ß√£o
        ${colegio}, em ${data}.</p>
        <p>${config.slogan}</p>
        <p>Ministro Presidente: ${config.ministro}</p>
    </div>
    `;

    let novaJanela = window.open("");
    novaJanela.document.write(conteudo);
}

function sortearColegio(estado){
    const colegios = {
        "Rio Grande do Sul":["Porto Alegre Norte","Serra Ga√∫cha","Fronteira Oeste","Litoral Sul"],
        "Pernambuco":["Recife Central","Agreste Pernambucano","Sert√£o do S√£o Francisco","Zona da Mata Norte"],
        "S√£o Paulo":["Capital Metropolitana","Interior Paulista","Vale do Para√≠ba","Baixada Santista"],
        "Goi√°s":["Goi√¢nia Metropolitana","Entorno do DF","Norte Goiano","Sudoeste Goiano"],
        "Amazonas":["Manaus Urbana","Alto Solim√µes","M√©dio Amazonas","Rio Negro"]
    };
    let lista = colegios[estado];
    return lista[Math.floor(Math.random()*lista.length)];
}

function abrirApuracao(){
    document.getElementById("home").classList.add("hidden");
    document.getElementById("apuracao").classList.remove("hidden");

    let total = votos.length;
    let percentual = total > 0 ? 100 : 0;

    document.getElementById("apuracao").innerHTML = `
        <h2>Apura√ß√£o P√∫blica</h2>
        <div class="barra-apuracao">
            <div class="barra-interna" style="width:${percentual}%"></div>
        </div>
        <p>Total de votos registrados: ${total}</p>
        <pre>${JSON.stringify(votos,null,2)}</pre>
    `;
}<!-- ================= SISTEMA COMPLETO ‚Äì MECANISMO AVAN√áADO ================= -->

<style>
/* URNA VISUAL MAIS REALISTA */
.urna-body{
    background:#d9d9d9;
    padding:30px;
    border-radius:12px;
    box-shadow:0 8px 20px rgba(0,0,0,0.4);
}
.urna-tela{
    background:#eef5e9;
    border:2px solid #999;
}
.numero-display{
    font-family:"Courier New", monospace;
}
.teclado button{
    border-radius:8px;
    font-weight:bold;
}
.teclado button::after{
    content:"‚Ä¢";
    font-size:10px;
    display:block;
}
.status-badge{
    padding:6px 12px;
    border-radius:20px;
    color:white;
}
.status-nao{background:#777;}
.status-andamento{background:green;}
.status-encerrada{background:red;}
</style>

<script>

/* ======================= BANCO LOCAL ======================= */

let banco = {
    eleitores:{},
    votos:[],
    apuracao:{},
    codigosUsados:{}
};

/* ======================= REGISTRO COM C√ìDIGO ======================= */

function registrar(){
    if(!usuario.value || !nomeCompleto.value || !discord.value || !senha.value || !estado.value){
        alert("Preencha todos os campos.");
        return;
    }

    let codigo = gerarCodigo(discord.value, senha.value);

    banco.eleitores[codigo] = {
        usuario:usuario.value,
        nome:nomeCompleto.value,
        discord:discord.value,
        estado:estado.value,
        votou:false
    };

    eleitor = banco.eleitores[codigo];
    eleitor.codigo = codigo;

    alert("C√≥digo gerado: " + codigo);
    document.getElementById("cadastro").classList.add("hidden");
    abrirUrna();
}

function gerarCodigo(discord, senha){
    let base = discord + senha + Date.now();
    return btoa(base).substring(0,12);
}

/* ======================= CONTROLE DE VOTA√á√ÉO ======================= */

function confirmar(){

    if(!eleitor || eleitor.votou){
        alert("C√≥digo j√° utilizado ou inv√°lido.");
        return;
    }

    if(numeroAtual===""){
        alert("Digite um n√∫mero.");
        return;
    }

    banco.votos.push({
        codigo:eleitor.codigo,
        cargo:cargos[etapa],
        voto:numeroAtual,
        estado:eleitor.estado
    });

    registrarApuracao(cargos[etapa], numeroAtual);

    avancar();
}

function registrarApuracao(cargo, numero){

    if(!banco.apuracao[cargo]){
        banco.apuracao[cargo] = {};
    }

    if(!banco.apuracao[cargo][numero]){
        banco.apuracao[cargo][numero] = 0;
    }

    banco.apuracao[cargo][numero]++;
}

/* ======================= FINALIZA√á√ÉO COM BLOQUEIO ======================= */

function finalizar(){

    eleitor.votou = true;
    banco.codigosUsados[eleitor.codigo] = true;

    let colegio = sortearColegio(eleitor.estado);

    document.getElementById("urna").innerHTML = `
    <div style="text-align:center;">
        <img src="${config.logo}" class="logo-eleicao">
        <h1>FIM</h1>
        <img src="${config.brasao}" class="brasao-eleicao">
        <p>O Tribunal Superior Eleitoral RPG agradece sua participa√ß√£o democr√°tica.</p>
        <p><strong>Circunscri√ß√£o Eleitoral:</strong> ${colegio}</p>
        <button onclick="gerarCertificado('${colegio}')">Baixar Certificado</button>
    </div>
    `;
}

/* ======================= CERTIFICA√á√ÉO COM HASH ======================= */

function gerarCertificado(colegio){

    let data = new Date().toLocaleDateString();

    let hash = btoa(eleitor.codigo + data).substring(0,16);

    let conteudo = `
    <div class="certificado">
        <img src="${config.logo}" class="logo-eleicao">
        <h2>CERTIFICADO DIGITAL DE VOTA√á√ÉO</h2>
        <img src="${config.brasao}" class="brasao-eleicao">
        <p>Certificamos que <strong>${eleitor.nome}</strong>, do estado ${eleitor.estado},
        participou regularmente do Processo Eleitoral Oficial RPG.</p>

        <p>Circunscri√ß√£o: ${colegio}</p>
        <p>Data: ${data}</p>
        <p>Slogan: ${config.slogan}</p>
        <p>Ministro Presidente: ${config.ministro}</p>

        <hr>
        <p><strong>C√≥digo de Verifica√ß√£o:</strong> ${hash}</p>
        <p>Este certificado pode ser validado atrav√©s do c√≥digo √∫nico registrado no sistema eleitoral oficial.</p>
    </div>
    `;

    let novaJanela = window.open("");
    novaJanela.document.write(conteudo);
}

/* ======================= APURA√á√ÉO AVAN√áADA ======================= */

function abrirApuracao(){

    document.getElementById("home").classList.add("hidden");
    document.getElementById("apuracao").classList.remove("hidden");

    let total = banco.votos.length;
    let html = `<h2>Apura√ß√£o P√∫blica Oficial</h2>`;
    html += `<p>Total de votos registrados: ${total}</p>`;

    for(let cargo in banco.apuracao){

        html += `<h3>${cargo}</h3>`;

        let totalCargo = Object.values(banco.apuracao[cargo]).reduce((a,b)=>a+b,0);

        for(let numero in banco.apuracao[cargo]){

            let votos = banco.apuracao[cargo][numero];
            let percentual = ((votos/totalCargo)*100).toFixed(2);

            html += `
            <div style="margin-bottom:10px;">
                <strong>N√∫mero ${numero}</strong> ‚Äî ${votos} votos (${percentual}%)
                <div class="barra-apuracao">
                    <div class="barra-interna" style="width:${percentual}%"></div>
                </div>
            </div>
            `;
        }
    }

    document.getElementById("apuracao").innerHTML = html;
}

/* ======================= CONTROLE ADMIN AVAN√áADO ======================= */

function iniciarEleicao(){
    statusEleicao="Em andamento";
    atualizarStatus();
}

function encerrarEleicao(){
    statusEleicao="Encerrada";
    atualizarStatus();
}

function atualizarStatus(){
    let badge = document.getElementById("statusEleicao");
    badge.innerText = statusEleicao;

    badge.className="status-badge";

    if(statusEleicao==="N√£o iniciada"){
        badge.classList.add("status-nao");
    }
    if(statusEleicao==="Em andamento"){
        badge.classList.add("status-andamento");
    }
    if(statusEleicao==="Encerrada"){
        badge.classList.add("status-encerrada");
    }
}

/* ======================= SEGURAN√áA EXTRA ======================= */

function trocarPersonagem(){
    if(eleitor){
        delete banco.eleitores[eleitor.codigo];
    }
    eleitor=null;
    numeroAtual="";
    etapa=0;
    alert("Cadastro removido. Fa√ßa novo registro.");
}

/* ======================= SEGUNDO TURNO CONFIGURA√á√ÉO ======================= */

let segundoTurnoAtivo = false;

function ativarSegundoTurno(){
    segundoTurnoAtivo = true;
    alert("Segundo turno ativado.");
}

</script><!-- ========================= -->
<!-- APURA√á√ÉO P√öBLICA COMPLETA -->
<!-- ========================= -->

<section id="apuracaoPublica" class="hidden">

<header class="header-apuracao">
    <div class="header-left">
        <img id="apuracaoLogo" class="logo-apuracao">
        <div>
            <h1>APURA√á√ÉO P√öBLICA OFICIAL</h1>
            <p id="apuracaoSubtitulo">Sistema Eleitoral RPG</p>
        </div>
    </div>

    <div class="header-right">
        <img id="apuracaoBrasao" class="brasao-apuracao">
    </div>
</header>

<div class="painel-status">
    <div class="status-box">
        <h3>Total de Eleitores</h3>
        <span id="totalEleitores">0</span>
    </div>

    <div class="status-box">
        <h3>Total de Votos</h3>
        <span id="totalVotos">0</span>
    </div>

    <div class="status-box">
        <h3>Percentual Apurado</h3>
        <span id="percentualApurado">0%</span>
    </div>

    <div class="status-box">
        <h3>Status</h3>
        <span id="statusApuracao" class="status-andamento">Em Andamento</span>
    </div>
</div>

<div class="filtro-estado">
    <label>Filtrar por Estado:</label>
    <select id="filtroEstado" onchange="atualizarApuracao()">
        <option value="todos">Todos</option>
        <option value="Rio Grande do Sul">Rio Grande do Sul</option>
        <option value="Pernambuco">Pernambuco</option>
        <option value="S√£o Paulo">S√£o Paulo</option>
        <option value="Goi√°s">Goi√°s</option>
        <option value="Amazonas">Amazonas</option>
    </select>
</div>

<div id="resultadoDeputado" class="bloco-resultado">
    <h2>Deputado Federal</h2>
    <div id="listaDeputado"></div>
</div>

<div id="resultadoPresidente" class="bloco-resultado">
    <h2>Presidente</h2>
    <div id="listaPresidente"></div>
</div>

<footer class="rodape-apuracao">
    <p>Transmiss√£o P√∫blica em Tempo Real ‚Ä¢ Sistema Eleitoral Oficial RPG</p>
</footer>

</section>

<style>
#apuracaoPublica{
    background:#f5f7fa;
    padding:20px;
    font-family:Arial;
}

.header-apuracao{
    display:flex;
    justify-content:space-between;
    align-items:center;
    border-bottom:3px solid #0b3d2e;
    padding-bottom:10px;
}

.header-left{
    display:flex;
    align-items:center;
    gap:15px;
}

.logo-apuracao, .brasao-apuracao{
    max-width:100px;
    height:auto;
}

.painel-status{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
    gap:15px;
    margin-top:20px;
}

.status-box{
    background:white;
    padding:15px;
    border-radius:10px;
    text-align:center;
    box-shadow:0 0 10px rgba(0,0,0,0.1);
}

.status-box span{
    font-size:22px;
    font-weight:bold;
}

.status-andamento{
    color:orange;
}

.status-finalizado{
    color:green;
}

.bloco-resultado{
    margin-top:30px;
    background:white;
    padding:20px;
    border-radius:10px;
    box-shadow:0 0 10px rgba(0,0,0,0.1);
}

.candidato-linha{
    margin-bottom:15px;
}

.candidato-info{
    display:flex;
    justify-content:space-between;
    margin-bottom:5px;
}

.barra-total{
    width:100%;
    background:#ddd;
    height:25px;
    border-radius:20px;
    overflow:hidden;
}

.barra-preenchida{
    height:100%;
    width:0%;
    transition:width 1s;
}

.rodape-apuracao{
    margin-top:30px;
    text-align:center;
    font-size:14px;
    color:#555;
}
</style>

<script>

function abrirApuracaoPublica(){
    document.getElementById("apuracaoPublica").classList.remove("hidden");
    atualizarApuracao();
}

function atualizarApuracao(){

    let estadoFiltro = document.getElementById("filtroEstado").value;

    let votosFiltrados = estadoFiltro === "todos" 
        ? votos 
        : votos.filter(v => v.estado === estadoFiltro);

    let total = votosFiltrados.length;
    let totalEleitoresSistema = eleitores.length;

    document.getElementById("totalEleitores").innerText = totalEleitoresSistema;
    document.getElementById("totalVotos").innerText = total;

    let percentual = totalEleitoresSistema > 0 
        ? ((total/totalEleitoresSistema)*100).toFixed(1) 
        : 0;

    document.getElementById("percentualApurado").innerText = percentual + "%";

    if(percentual == 100){
        document.getElementById("statusApuracao").innerText="Finalizado";
        document.getElementById("statusApuracao").className="status-finalizado";
    }

    gerarResultado("Deputado", "listaDeputado", votosFiltrados, total);
    gerarResultado("Presidente", "listaPresidente", votosFiltrados, total);
}

function gerarResultado(cargo, elementoId, votosFiltrados, total){

    let container = document.getElementById(elementoId);
    container.innerHTML="";

    let contagem = {};

    votosFiltrados.forEach(v=>{
        let numero = v[cargo.toLowerCase()];
        if(!contagem[numero]) contagem[numero]=0;
        contagem[numero]++;
    });

    Object.keys(contagem).sort((a,b)=>contagem[b]-contagem[a]).forEach(numero=>{

        let qtd = contagem[numero];
        let perc = total>0 ? ((qtd/total)*100).toFixed(1) : 0;

        let linha = document.createElement("div");
        linha.className="candidato-linha";

        linha.innerHTML=`
            <div class="candidato-info">
                <strong>N¬∫ ${numero}</strong>
                <span>${qtd} votos (${perc}%)</span>
            </div>
            <div class="barra-total">
                <div class="barra-preenchida" style="width:${perc}%"></div>
            </div>
        `;

        container.appendChild(linha);
    });

}

setInterval(()=>{
    if(!document.getElementById("apuracaoPublica").classList.contains("hidden")){
        atualizarApuracao();
    }
},5000);

</script><!-- ========================= -->
<!-- DETALHAMENTO AVAN√áADO APURA√á√ÉO -->
<!-- ========================= -->

<div class="painel-graficos">

    <div class="grafico-box">
        <h3>Distribui√ß√£o por Estado</h3>
        <div id="graficoEstados"></div>
    </div>

    <div class="grafico-box">
        <h3>√öltimos Votos Registrados</h3>
        <div id="ultimosVotos" class="ultimos-votos"></div>
    </div>

</div>

<div class="auditoria-publica">
    <h2>Auditoria e Verifica√ß√£o P√∫blica</h2>

    <div class="auditoria-grid">

        <div class="auditoria-card">
            <h4>Hash Global da Apura√ß√£o</h4>
            <p id="hashGlobal">---</p>
        </div>

        <div class="auditoria-card">
            <h4>Integridade dos Registros</h4>
            <p id="integridadeStatus">Verificando...</p>
        </div>

        <div class="auditoria-card">
            <h4>C√≥digos de Vota√ß√£o Validados</h4>
            <p id="codigosValidados">0</p>
        </div>

        <div class="auditoria-card">
            <h4>Hor√°rio da √öltima Atualiza√ß√£o</h4>
            <p id="ultimaAtualizacao">---</p>
        </div>

    </div>
</div>

<style>
.painel-graficos{
    margin-top:30px;
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(350px,1fr));
    gap:20px;
}

.grafico-box{
    background:white;
    padding:20px;
    border-radius:10px;
    box-shadow:0 0 10px rgba(0,0,0,0.08);
}

.estado-barra{
    margin-bottom:12px;
}

.estado-nome{
    display:flex;
    justify-content:space-between;
    margin-bottom:4px;
    font-size:14px;
}

.estado-progress{
    width:100%;
    height:18px;
    background:#e0e0e0;
    border-radius:15px;
    overflow:hidden;
}

.estado-fill{
    height:100%;
    width:0%;
    transition:width 1s;
    background:#0b3d2e;
}

.ultimos-votos{
    max-height:250px;
    overflow-y:auto;
    font-size:13px;
}

.voto-item{
    border-bottom:1px solid #ddd;
    padding:6px 0;
}

.auditoria-publica{
    margin-top:40px;
    background:#ffffff;
    padding:25px;
    border-radius:10px;
    box-shadow:0 0 15px rgba(0,0,0,0.08);
}

.auditoria-grid{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
    gap:20px;
    margin-top:15px;
}

.auditoria-card{
    background:#f4f6f8;
    padding:15px;
    border-radius:8px;
    text-align:center;
    font-size:14px;
}

.auditoria-card h4{
    margin-bottom:8px;
}
</style>

<script>

function atualizarDetalhamentoApuracao(){

    gerarGraficoEstados();
    atualizarUltimosVotos();
    gerarAuditoriaPublica();

}

function gerarGraficoEstados(){

    let container = document.getElementById("graficoEstados");
    container.innerHTML="";

    let contagemEstados = {};
    votos.forEach(v=>{
        if(!contagemEstados[v.estado]) contagemEstados[v.estado]=0;
        contagemEstados[v.estado]++;
    });

    let total = votos.length;

    Object.keys(contagemEstados).forEach(estado=>{

        let qtd = contagemEstados[estado];
        let perc = total>0 ? ((qtd/total)*100).toFixed(1) : 0;

        let div = document.createElement("div");
        div.className="estado-barra";

        div.innerHTML=`
            <div class="estado-nome">
                <span>${estado}</span>
                <span>${qtd} (${perc}%)</span>
            </div>
            <div class="estado-progress">
                <div class="estado-fill" style="width:${perc}%"></div>
            </div>
        `;

        container.appendChild(div);
    });

}

function atualizarUltimosVotos(){

    let container = document.getElementById("ultimosVotos");
    container.innerHTML="";

    let ultimos = votos.slice(-10).reverse();

    ultimos.forEach(v=>{
        let div = document.createElement("div");
        div.className="voto-item";
        div.innerHTML=`
            <strong>${v.estado}</strong> ‚Ä¢ Dep: ${v.deputado} ‚Ä¢ Pres: ${v.presidente}<br>
            <small>C√≥digo: ${v.codigo} ‚Ä¢ ${v.timestamp}</small>
        `;
        container.appendChild(div);
    });

}

function gerarAuditoriaPublica(){

    let dadosString = JSON.stringify(votos);
    let hash = gerarHashSimples(dadosString);

    document.getElementById("hashGlobal").innerText = hash;

    document.getElementById("integridadeStatus").innerText = 
        hash.length > 0 ? "Registros √≠ntegros" : "Falha detectada";

    document.getElementById("codigosValidados").innerText = votos.length;

    document.getElementById("ultimaAtualizacao").innerText = 
        new Date().toLocaleString();

}

function gerarHashSimples(str){

    let hash = 0;
    for(let i=0;i<str.length;i++){
        let chr = str.charCodeAt(i);
        hash = ((hash<<5)-hash)+chr;
        hash |= 0;
    }
    return "RPG-"+Math.abs(hash);

}

setInterval(()=>{
    if(!document.getElementById("apuracaoPublica").classList.contains("hidden")){
        atualizarDetalhamentoApuracao();
    }
},5000);

</script><!-- ================================= -->
<!-- PAINEL ADMINISTRATIVO COMPLETO -->
<!-- ================================= -->

<section id="painelAdminCompleto" class="hidden">

<header class="admin-header">
    <h1>Painel Administrativo Central</h1>
    <button onclick="voltarHome()">Voltar</button>
</header>

<nav class="admin-menu">
    <button onclick="abrirAbaAdmin('configGeral')">Configura√ß√µes Gerais</button>
    <button onclick="abrirAbaAdmin('gerenciarCandidatos')">Candidatos</button>
    <button onclick="abrirAbaAdmin('gerenciarEleitores')">Eleitores</button>
    <button onclick="abrirAbaAdmin('codigosVotacao')">C√≥digos</button>
    <button onclick="abrirAbaAdmin('controleEleicao')">Controle Elei√ß√£o</button>
    <button onclick="abrirAbaAdmin('auditoriaAdmin')">Auditoria</button>
</nav>

<!-- CONFIG GERAL -->
<div id="configGeral" class="admin-aba hidden">
    <h2>Configura√ß√µes Gerais</h2>

    <label>Logo Oficial (URL)</label>
    <input type="text" id="adminLogo">

    <label>Bras√£o Oficial (URL)</label>
    <input type="text" id="adminBrasao">

    <label>Nome da Elei√ß√£o</label>
    <input type="text" id="adminNomeEleicao">

    <label>Ministro Presidente</label>
    <input type="text" id="adminMinistro">

    <button onclick="salvarConfigAdmin()">Salvar Configura√ß√µes</button>
</div>

<!-- CANDIDATOS -->
<div id="gerenciarCandidatos" class="admin-aba hidden">
    <h2>Cadastro de Candidatos</h2>

    <select id="cargoCandidato">
        <option value="Deputado">Deputado</option>
        <option value="Presidente">Presidente</option>
    </select>

    <input type="text" id="numeroCandidato" placeholder="N√∫mero">
    <input type="text" id="nomeCandidato" placeholder="Nome Completo">
    <input type="text" id="partidoCandidato" placeholder="Partido">

    <button onclick="adicionarCandidato()">Adicionar</button>

    <div id="listaCandidatosAdmin"></div>
</div>

<!-- ELEITORES -->
<div id="gerenciarEleitores" class="admin-aba hidden">
    <h2>Eleitores Registrados</h2>
    <div id="listaEleitoresAdmin"></div>
</div>

<!-- C√ìDIGOS -->
<div id="codigosVotacao" class="admin-aba hidden">
    <h2>Gera√ß√£o de C√≥digos de Vota√ß√£o</h2>

    <input type="number" id="quantidadeCodigos" placeholder="Quantidade">
    <button onclick="gerarCodigosAdmin()">Gerar</button>

    <div id="listaCodigosAdmin"></div>
</div>

<!-- CONTROLE -->
<div id="controleEleicao" class="admin-aba hidden">
    <h2>Controle da Elei√ß√£o</h2>

    <button onclick="abrirEleicao()">Abrir Elei√ß√£o</button>
    <button onclick="encerrarEleicao()">Encerrar Elei√ß√£o</button>
    <button onclick="zerarSistema()">Resetar Sistema</button>

    <p>Status Atual: <strong id="statusEleicaoAdmin">Fechada</strong></p>
</div>

<!-- AUDITORIA -->
<div id="auditoriaAdmin" class="admin-aba hidden">
    <h2>Auditoria Interna</h2>
    <pre id="logAuditoria"></pre>
</div>

</section>

<style>
#painelAdminCompleto{
    padding:20px;
    background:#eef2f5;
}

.admin-header{
    display:flex;
    justify-content:space-between;
    align-items:center;
}

.admin-menu{
    margin-top:15px;
    display:flex;
    flex-wrap:wrap;
    gap:10px;
}

.admin-menu button{
    padding:10px 15px;
}

.admin-aba{
    margin-top:20px;
    background:white;
    padding:20px;
    border-radius:8px;
}

.admin-aba input, .admin-aba select{
    display:block;
    margin-bottom:10px;
    padding:8px;
    width:100%;
    max-width:400px;
}
</style>

<script>

/* ===========================
   VARI√ÅVEIS GLOBAIS SISTEMA
=========================== */

let sistemaConfig = {
    logo:"",
    brasao:"",
    nomeEleicao:"Elei√ß√£o Oficial RPG",
    ministro:""
};

let candidatos = [];
let eleitores = [];
let codigos = [];
let eleicaoAberta = false;

/* ===========================
   NAVEGA√á√ÉO ADMIN
=========================== */

function abrirPainelAdmin(){
    document.getElementById("painelAdminCompleto").classList.remove("hidden");
}

function abrirAbaAdmin(id){
    document.querySelectorAll(".admin-aba").forEach(div=>div.classList.add("hidden"));
    document.getElementById(id).classList.remove("hidden");
}

/* ===========================
   CONFIGURA√á√ÉO
=========================== */

function salvarConfigAdmin(){
    sistemaConfig.logo = adminLogo.value;
    sistemaConfig.brasao = adminBrasao.value;
    sistemaConfig.nomeEleicao = adminNomeEleicao.value;
    sistemaConfig.ministro = adminMinistro.value;
    alert("Configura√ß√µes salvas.");
}

/* ===========================
   CANDIDATOS
=========================== */

function adicionarCandidato(){
    let candidato = {
        cargo: cargoCandidato.value,
        numero: numeroCandidato.value,
        nome: nomeCandidato.value,
        partido: partidoCandidato.value
    };

    candidatos.push(candidato);
    atualizarListaCandidatosAdmin();
}

function atualizarListaCandidatosAdmin(){
    let div = document.getElementById("listaCandidatosAdmin");
    div.innerHTML="";

    candidatos.forEach(c=>{
        div.innerHTML += `
            <p><strong>${c.cargo}</strong> N¬∫ ${c.numero} - ${c.nome} (${c.partido})</p>
        `;
    });
}

/* ===========================
   ELEITORES
=========================== */

function atualizarListaEleitoresAdmin(){
    let div = document.getElementById("listaEleitoresAdmin");
    div.innerHTML="";

    eleitores.forEach(e=>{
        div.innerHTML += `
            <p>${e.nome} ‚Ä¢ ${e.estado} ‚Ä¢ C√≥digo: ${e.codigo} ‚Ä¢ Votou: ${e.votou}</p>
        `;
    });
}

/* ===========================
   C√ìDIGOS
=========================== */

function gerarCodigosAdmin(){

    let qtd = parseInt(quantidadeCodigos.value);

    for(let i=0;i<qtd;i++){
        let codigo = "RPG-"+Math.random().toString(36).substr(2,8).toUpperCase();
        codigos.push({codigo:codigo, usado:false});
    }

    atualizarListaCodigosAdmin();
}

function atualizarListaCodigosAdmin(){
    let div = document.getElementById("listaCodigosAdmin");
    div.innerHTML="";

    codigos.forEach(c=>{
        div.innerHTML += `
            <p>${c.codigo} ‚Ä¢ Usado: ${c.usado}</p>
        `;
    });
}

/* ===========================
   CONTROLE ELEI√á√ÉO
=========================== */

function abrirEleicao(){
    eleicaoAberta = true;
    statusEleicaoAdmin.innerText="Aberta";
}

function encerrarEleicao(){
    eleicaoAberta = false;
    statusEleicaoAdmin.innerText="Encerrada";
}

function zerarSistema(){
    votos=[];
    candidatos=[];
    eleitores=[];
    codigos=[];
    atualizarListaCandidatosAdmin();
    atualizarListaEleitoresAdmin();
    atualizarListaCodigosAdmin();
    alert("Sistema resetado.");
}

/* ===========================
   AUDITORIA
=========================== */

function registrarLog(msg){
    let log = document.getElementById("logAuditoria");
    log.innerText += new Date().toLocaleString()+" - "+msg+"\n";
}

/* ===========================
   INTEGRA√á√ÉO COM APURA√á√ÉO
=========================== */

function sincronizarApuracaoVisual(){
    document.getElementById("apuracaoLogo").src = sistemaConfig.logo;
    document.getElementById("apuracaoBrasao").src = sistemaConfig.brasao;
    document.getElementById("apuracaoSubtitulo").innerText = sistemaConfig.nomeEleicao;
}

setInterval(()=>{
    sincronizarApuracaoVisual();
},2000);

</script><!-- ========================================= -->
<!-- BANCO DE DADOS LOCAL COMPLETO (INDEXADO) -->
<!-- ========================================= -->

<script>

/* ======================================================
   BANCO DE DADOS LOCAL (SIMULA√á√ÉO PROFISSIONAL)
   Persist√™ncia via localStorage
====================================================== */

const DB_KEY = "SISTEMA_ELEITORAL_RPG_V1";

let db = {
    config: {},
    candidatos: [],
    eleitores: [],
    codigos: [],
    votos: [],
    logs: [],
    status: {
        eleicaoAberta: false
    }
};

/* ===========================
   INICIALIZA√á√ÉO DO SISTEMA
=========================== */

function inicializarSistema(){
    let dadosSalvos = localStorage.getItem(DB_KEY);

    if(dadosSalvos){
        db = JSON.parse(dadosSalvos);
    }else{
        salvarDB();
    }

    sincronizarVariaveisGlobais();
}

function salvarDB(){
    localStorage.setItem(DB_KEY, JSON.stringify(db));
}

function sincronizarVariaveisGlobais(){
    sistemaConfig = db.config;
    candidatos = db.candidatos;
    eleitores = db.eleitores;
    codigos = db.codigos;
    votos = db.votos;
    eleicaoAberta = db.status.eleicaoAberta;
}

/* ===========================
   SISTEMA DE LOG
=========================== */

function logSistema(acao){
    db.logs.push({
        acao: acao,
        data: new Date().toLocaleString()
    });
    salvarDB();
}

/* ===========================
   GERENCIAMENTO DE ELEITORES
=========================== */

function registrarEleitor(nome, estado, codigo){

    let codigoValido = db.codigos.find(c => c.codigo === codigo && !c.usado);

    if(!codigoValido){
        alert("C√≥digo inv√°lido ou j√° utilizado.");
        return false;
    }

    let eleitor = {
        id: gerarID(),
        nome: nome,
        estado: estado,
        codigo: codigo,
        votou: false
    };

    db.eleitores.push(eleitor);
    codigoValido.usado = true;

    salvarDB();
    logSistema("Eleitor registrado: " + nome);

    return true;
}

/* ===========================
   SISTEMA DE VOTA√á√ÉO
=========================== */

function registrarVoto(eleitorID, deputadoNumero, presidenteNumero){

    if(!db.status.eleicaoAberta){
        alert("Elei√ß√£o encerrada.");
        return false;
    }

    let eleitor = db.eleitores.find(e => e.id === eleitorID);

    if(!eleitor || eleitor.votou){
        alert("Eleitor inv√°lido ou j√° votou.");
        return false;
    }

    let voto = {
        id: gerarID(),
        eleitorID: eleitorID,
        estado: eleitor.estado,
        deputado: deputadoNumero,
        presidente: presidenteNumero,
        timestamp: new Date().toLocaleString(),
        hash: ""
    };

    voto.hash = gerarHashVoto(voto);

    db.votos.push(voto);
    eleitor.votou = true;

    salvarDB();
    logSistema("Voto registrado - Eleitor: " + eleitor.nome);

    return true;
}

/* ===========================
   CONTAGEM AUTOM√ÅTICA INDEXADA
=========================== */

function contarVotosPorCargo(cargo){

    let resultado = {};

    db.votos.forEach(v=>{
        let numero = v[cargo];
        if(!resultado[numero]) resultado[numero]=0;
        resultado[numero]++;
    });

    return resultado;
}

/* ===========================
   VERIFICA√á√ÉO DE INTEGRIDADE
=========================== */

function verificarIntegridade(){

    let valido = true;

    db.votos.forEach(v=>{
        let hashAtual = gerarHashVoto(v);
        if(hashAtual !== v.hash){
            valido = false;
        }
    });

    return valido;
}

/* ===========================
   HASH PROFISSIONAL SIMULADO
=========================== */

function gerarHashVoto(voto){

    let base = voto.eleitorID + voto.deputado + voto.presidente + voto.timestamp;

    let hash = 0;
    for(let i=0;i<base.length;i++){
        let chr = base.charCodeAt(i);
        hash = ((hash<<5)-hash)+chr;
        hash |= 0;
    }

    return "VOTO-"+Math.abs(hash);
}

/* ===========================
   GERA√á√ÉO DE C√ìDIGOS INDEXADOS
=========================== */

function gerarCodigoUnico(){

    let codigo;
    do{
        codigo = "RPG-"+Math.random().toString(36).substr(2,8).toUpperCase();
    }while(db.codigos.find(c=>c.codigo===codigo));

    return codigo;
}

function gerarCodigosAdmin(){

    let qtd = parseInt(quantidadeCodigos.value);

    for(let i=0;i<qtd;i++){
        db.codigos.push({
            codigo: gerarCodigoUnico(),
            usado: false
        });
    }

    salvarDB();
    atualizarListaCodigosAdmin();
    logSistema("C√≥digos gerados: " + qtd);
}

/* ===========================
   RESET COMPLETO CONTROLADO
=========================== */

function resetarSistemaCompleto(){

    localStorage.removeItem(DB_KEY);

    db = {
        config:{},
        candidatos:[],
        eleitores:[],
        codigos:[],
        votos:[],
        logs:[],
        status:{eleicaoAberta:false}
    };

    salvarDB();
    sincronizarVariaveisGlobais();

    alert("Sistema completamente resetado.");
}

/* ===========================
   EXPORTA√á√ÉO DE DADOS
=========================== */

function exportarJSON(){

    let dataStr = "data:text/json;charset=utf-8," + 
        encodeURIComponent(JSON.stringify(db,null,2));

    let dlAnchor = document.createElement('a');
    dlAnchor.setAttribute("href", dataStr);
    dlAnchor.setAttribute("download", "backup_eleicao_rpg.json");
    dlAnchor.click();
}

/* ===========================
   IMPORTA√á√ÉO DE BACKUP
=========================== */

function importarJSON(event){

    let reader = new FileReader();

    reader.onload = function(){
        db = JSON.parse(reader.result);
        salvarDB();
        sincronizarVariaveisGlobais();
        alert("Backup restaurado com sucesso.");
    };

    reader.readAsText(event.target.files[0]);
}

/* ===========================
   UTILIT√ÅRIO
=========================== */

function gerarID(){
    return "ID-"+Date.now()+"-"+Math.random().toString(36).substr(2,5);
}

/* ===========================
   INICIALIZA√á√ÉO AUTOM√ÅTICA
=========================== */

window.onload = function(){
    inicializarSistema();
};

</script><!-- ===================================================== -->
<!-- LAYOUT GERAL RESPONSIVO + INDEXA√á√ÉO COMPLETA DO SITE -->
<!-- ===================================================== -->

<style>

/* RESET */
*{
    margin:0;
    padding:0;
    box-sizing:border-box;
    font-family:Arial, Helvetica, sans-serif;
}

/* VARI√ÅVEIS VISUAIS */
:root{
    --cor-primaria:#0b3d2e;
    --cor-secundaria:#145c43;
    --cor-fundo:#f4f6f8;
    --cor-card:#ffffff;
    --cor-borda:#e0e0e0;
}

/* ESTRUTURA GERAL */
body{
    background:var(--cor-fundo);
    min-height:100vh;
    display:flex;
    flex-direction:column;
}

header.site-header{
    background:var(--cor-primaria);
    color:white;
    padding:15px 20px;
    display:flex;
    justify-content:space-between;
    align-items:center;
}

.header-left{
    display:flex;
    align-items:center;
    gap:15px;
}

.header-left img{
    max-height:50px;
}

nav.menu-principal{
    background:var(--cor-secundaria);
    display:flex;
    flex-wrap:wrap;
    gap:10px;
    padding:10px 20px;
}

nav.menu-principal button{
    background:white;
    border:none;
    padding:8px 14px;
    border-radius:6px;
    cursor:pointer;
    font-weight:bold;
}

nav.menu-principal button:hover{
    background:#dcdcdc;
}

main{
    flex:1;
    padding:20px;
}

/* ABAS GERAIS */
.aba{
    display:none;
}

.aba.ativa{
    display:block;
}

/* CARDS */
.card{
    background:var(--cor-card);
    padding:20px;
    border-radius:10px;
    box-shadow:0 0 10px rgba(0,0,0,0.05);
    margin-bottom:20px;
}

/* FORMUL√ÅRIOS */
input, select, button{
    padding:10px;
    margin-top:8px;
    margin-bottom:15px;
    width:100%;
    max-width:450px;
}

button.primario{
    background:var(--cor-primaria);
    color:white;
    border:none;
    cursor:pointer;
}

button.secundario{
    background:#444;
    color:white;
    border:none;
}

/* GRID RESPONSIVO */
.grid-2{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(300px,1fr));
    gap:20px;
}

/* RODAP√â */
footer{
    background:var(--cor-primaria);
    color:white;
    text-align:center;
    padding:10px;
    font-size:14px;
}

/* RESPONSIVO */
@media(max-width:768px){
    header.site-header{
        flex-direction:column;
        align-items:flex-start;
        gap:10px;
    }

    nav.menu-principal{
        flex-direction:column;
    }
}

</style>

<!-- ================= HEADER ================= -->

<header class="site-header">
    <div class="header-left">
        <img id="logoSistemaHeader">
        <div>
            <h2 id="tituloSistemaHeader">Sistema Eleitoral RPG</h2>
            <small id="subtituloSistemaHeader">Painel Oficial</small>
        </div>
    </div>

    <div>
        <strong>Status:</strong>
        <span id="statusGlobalHeader">Fechada</span>
    </div>
</header>

<!-- ================= MENU ================= -->

<nav class="menu-principal">
    <button onclick="abrirAba('home')">In√≠cio</button>
    <button onclick="abrirAba('urna')">Urna</button>
    <button onclick="abrirAba('apuracaoPublica')">Apura√ß√£o</button>
    <button onclick="abrirAba('painelAdminCompleto')">Admin</button>
</nav>

<!-- ================= CONTE√öDO ================= -->

<main>

<!-- HOME -->
<section id="home" class="aba ativa">
    <div class="card">
        <h2>Bem-vindo ao Sistema Eleitoral Oficial RPG</h2>
        <p>Plataforma completa de vota√ß√£o, apura√ß√£o p√∫blica e gest√£o administrativa.</p>
    </div>

    <div class="grid-2">
        <div class="card">
            <h3>Status da Elei√ß√£o</h3>
            <p id="statusHome">Elei√ß√£o Fechada</p>
        </div>

        <div class="card">
            <h3>Total de Votos</h3>
            <p id="totalVotosHome">0</p>
        </div>
    </div>
</section>

<!-- URNA -->
<section id="urna" class="aba">
    <div class="card">
        <h2>Identifica√ß√£o do Eleitor</h2>

        <input type="text" id="nomeEleitorInput" placeholder="Nome Completo">
        <select id="estadoEleitorInput">
            <option value="">Selecione o Estado</option>
            <option>Rio Grande do Sul</option>
            <option>Pernambuco</option>
            <option>S√£o Paulo</option>
            <option>Goi√°s</option>
            <option>Amazonas</option>
        </select>
        <input type="text" id="codigoEleitorInput" placeholder="C√≥digo de Vota√ß√£o">

        <button class="primario" onclick="validarEleitorParaVoto()">Validar e Prosseguir</button>
    </div>

    <div id="urnaVotacaoArea" class="card" style="display:none;">
        <h2>Vota√ß√£o</h2>

        <h3>Deputado</h3>
        <input type="text" id="votoDeputadoInput" placeholder="N√∫mero do Deputado">

        <h3>Presidente</h3>
        <input type="text" id="votoPresidenteInput" placeholder="N√∫mero do Presidente">

        <button class="primario" onclick="confirmarVoto()">Confirmar Voto</button>
    </div>
</section>

</main>

<!-- ================= RODAP√â ================= -->

<footer>
    Sistema Eleitoral Oficial RPG ‚Ä¢ Plataforma Completa
</footer>

<!-- ================= SCRIPT INDEXADOR ================= -->

<script>

/* ===========================
   CONTROLE DE ABAS
=========================== */

function abrirAba(id){

    document.querySelectorAll(".aba").forEach(sec=>{
        sec.classList.remove("ativa");
    });

    document.getElementById(id).classList.add("ativa");

    if(id === "apuracaoPublica"){
        atualizarApuracao();
        atualizarDetalhamentoApuracao();
    }

    if(id === "painelAdminCompleto"){
        atualizarListaCandidatosAdmin();
        atualizarListaEleitoresAdmin();
        atualizarListaCodigosAdmin();
    }
}

/* ===========================
   SINCRONIZA√á√ÉO VISUAL GLOBAL
=========================== */

function atualizarLayoutGlobal(){

    document.getElementById("logoSistemaHeader").src = db.config.logo || "";
    document.getElementById("tituloSistemaHeader").innerText = 
        db.config.nomeEleicao || "Sistema Eleitoral RPG";

    document.getElementById("subtituloSistemaHeader").innerText = 
        "Ministro: " + (db.config.ministro || "---");

    let status = db.status.eleicaoAberta ? "Aberta" : "Fechada";

    document.getElementById("statusGlobalHeader").innerText = status;
    document.getElementById("statusHome").innerText = "Elei√ß√£o " + status;
    document.getElementById("totalVotosHome").innerText = db.votos.length;
}

/* ===========================
   VALIDA√á√ÉO DO ELEITOR
=========================== */

let eleitorLogadoID = null;

function validarEleitorParaVoto(){

    let nome = nomeEleitorInput.value;
    let estado = estadoEleitorInput.value;
    let codigo = codigoEleitorInput.value;

    if(!nome || !estado || !codigo){
        alert("Preencha todos os campos.");
        return;
    }

    let sucesso = registrarEleitor(nome, estado, codigo);

    if(sucesso){
        eleitorLogadoID = db.eleitores[db.eleitores.length-1].id;
        document.getElementById("urnaVotacaoArea").style.display="block";
        atualizarLayoutGlobal();
    }
}

/* ===========================
   CONFIRMA√á√ÉO DE VOTO
=========================== */

function confirmarVoto(){

    let dep = votoDeputadoInput.value;
    let pres = votoPresidenteInput.value;

    if(!dep || !pres){
        alert("Digite os n√∫meros.");
        return;
    }

    let sucesso = registrarVoto(eleitorLogadoID, dep, pres);

    if(sucesso){
        alert("Voto registrado com sucesso.");
        document.getElementById("urnaVotacaoArea").style.display="none";
        atualizarLayoutGlobal();
    }
}

/* ===========================
   ATUALIZA√á√ÉO CONT√çNUA
=========================== */

setInterval(()=>{
    atualizarLayoutGlobal();
},3000);

</script><!-- ===================================================== -->
<!-- APRIMORAMENTO VISUAL URNA + DASHBOARD + INDEX GLOBAL -->
<!-- ===================================================== -->

<style>

/* URNA VISUAL ESTILO REALISTA */
.urna-box{
    background:#d9d9d9;
    border:4px solid #999;
    border-radius:15px;
    padding:20px;
    max-width:500px;
    margin:auto;
}

.tela-urna{
    background:#000;
    color:#00ff00;
    padding:15px;
    border-radius:10px;
    min-height:120px;
    font-family:monospace;
    margin-bottom:15px;
}

.teclado-urna{
    display:grid;
    grid-template-columns:repeat(3,1fr);
    gap:10px;
}

.tecla{
    background:#444;
    color:white;
    padding:15px;
    text-align:center;
    font-size:18px;
    border-radius:8px;
    cursor:pointer;
}

.tecla:hover{
    background:#222;
}

.tecla-confirma{
    background:green;
}

.tecla-corrige{
    background:orange;
}

.tecla-branco{
    background:white;
    color:black;
}

/* DASHBOARD HOME */
.dashboard-grid{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
    gap:20px;
    margin-top:20px;
}

.dashboard-card{
    background:white;
    padding:20px;
    border-radius:10px;
    text-align:center;
    box-shadow:0 0 10px rgba(0,0,0,0.05);
}

.dashboard-card h2{
    font-size:28px;
    margin-bottom:10px;
}

</style>

<!-- ================= ATUALIZA√á√ÉO URNA ================= -->

<section id="urnaVisual" class="aba">
    <div class="urna-box">

        <div class="tela-urna" id="telaUrna">
            INSIRA SEU VOTO
        </div>

        <div class="teclado-urna">
            <div class="tecla" onclick="digitarNumero('1')">1</div>
            <div class="tecla" onclick="digitarNumero('2')">2</div>
            <div class="tecla" onclick="digitarNumero('3')">3</div>
            <div class="tecla" onclick="digitarNumero('4')">4</div>
            <div class="tecla" onclick="digitarNumero('5')">5</div>
            <div class="tecla" onclick="digitarNumero('6')">6</div>
            <div class="tecla" onclick="digitarNumero('7')">7</div>
            <div class="tecla" onclick="digitarNumero('8')">8</div>
            <div class="tecla" onclick="digitarNumero('9')">9</div>
            <div class="tecla tecla-branco" onclick="votoBranco()">BRANCO</div>
            <div class="tecla" onclick="digitarNumero('0')">0</div>
            <div class="tecla tecla-corrige" onclick="corrigirVoto()">CORRIGE</div>
        </div>

        <div style="margin-top:15px;text-align:center;">
            <button class="primario" onclick="confirmarVotoUrna()">CONFIRMA</button>
        </div>

    </div>
</section>

<!-- ================= DASHBOARD APRIMORADO ================= -->

<script>

/* ===========================
   URNA FUNCIONAL COMPLETA
=========================== */

let votoDigitado = "";
let etapaVotacao = "deputado";

function digitarNumero(num){
    votoDigitado += num;
    atualizarTelaUrna();
}

function corrigirVoto(){
    votoDigitado = "";
    atualizarTelaUrna();
}

function votoBranco(){
    votoDigitado = "BRANCO";
    atualizarTelaUrna();
}

function atualizarTelaUrna(){
    document.getElementById("telaUrna").innerText =
        etapaVotacao.toUpperCase() + ": " + votoDigitado;
}

function confirmarVotoUrna(){

    if(!eleitorLogadoID){
        alert("Valide o eleitor primeiro.");
        return;
    }

    if(etapaVotacao === "deputado"){
        votoDeputadoInput.value = votoDigitado;
        votoDigitado="";
        etapaVotacao="presidente";
        atualizarTelaUrna();
        return;
    }

    if(etapaVotacao === "presidente"){
        votoPresidenteInput.value = votoDigitado;
        votoDigitado="";
        etapaVotacao="deputado";

        confirmarVoto();
        atualizarTelaUrna();
    }
}

/* ===========================
   DASHBOARD DIN√ÇMICO HOME
=========================== */

function atualizarDashboardHome(){

    let totalEleitores = db.eleitores.length;
    let totalVotos = db.votos.length;
    let totalCodigos = db.codigos.length;
    let eleicaoStatus = db.status.eleicaoAberta ? "ABERTA" : "FECHADA";

    document.getElementById("home").innerHTML = `
        <div class="dashboard-grid">

            <div class="dashboard-card">
                <h2>${totalEleitores}</h2>
                <p>Eleitores Registrados</p>
            </div>

            <div class="dashboard-card">
                <h2>${totalVotos}</h2>
                <p>Votos Computados</p>
            </div>

            <div class="dashboard-card">
                <h2>${totalCodigos}</h2>
                <p>C√≥digos Gerados</p>
            </div>

            <div class="dashboard-card">
                <h2>${eleicaoStatus}</h2>
                <p>Status da Elei√ß√£o</p>
            </div>

        </div>
    `;
}

/* ===========================
   INDEXA√á√ÉO GLOBAL COMPLETA
=========================== */

function sincronizacaoTotalSistema(){

    atualizarLayoutGlobal();
    atualizarDashboardHome();

    if(document.getElementById("apuracaoPublica").classList.contains("ativa")){
        atualizarApuracao();
        atualizarDetalhamentoApuracao();
    }

    if(document.getElementById("painelAdminCompleto").classList.contains("ativa")){
        atualizarListaCandidatosAdmin();
        atualizarListaEleitoresAdmin();
        atualizarListaCodigosAdmin();
    }

}

/* ===========================
   LOOP GLOBAL DO SISTEMA
=========================== */

setInterval(()=>{
    sincronizacaoTotalSistema();
},4000);

</script><!-- ===================================================== -->
<!-- FINALIZA√á√ÉO PROFISSIONAL DO SISTEMA ELEITORAL RPG -->
<!-- SEGURAN√áA ‚Ä¢ CERTIFICA√á√ÉO ‚Ä¢ BLOQUEIOS ‚Ä¢ RELAT√ìRIOS -->
<!-- ===================================================== -->

<style>

/* TELA FINAL */
.tela-finalizacao{
    background:#ffffff;
    padding:40px;
    border-radius:12px;
    box-shadow:0 0 20px rgba(0,0,0,0.08);
    max-width:900px;
    margin:auto;
}

.tela-finalizacao h1{
    text-align:center;
    margin-bottom:20px;
}

.certificado-final{
    border:4px solid #0b3d2e;
    padding:30px;
    margin-top:20px;
    background:#fdfdfd;
}

.certificado-final h2{
    text-align:center;
    margin-bottom:20px;
}

.selo-integridade{
    margin-top:20px;
    padding:10px;
    background:#e8f5e9;
    border-left:5px solid green;
}

.botao-exportar{
    margin-top:20px;
}

</style>

<section id="finalizacaoSistema" class="aba">

<div class="tela-finalizacao">

<h1>Encerramento Oficial da Elei√ß√£o</h1>

<div class="certificado-final" id="certificadoFinal">
</div>

<div class="selo-integridade" id="seloIntegridadeFinal">
</div>

<button class="primario botao-exportar" onclick="exportarResultadoFinal()">
Exportar Resultado Oficial
</button>

</div>

</section>

<script>

/* ===========================
   ENCERRAMENTO DEFINITIVO
=========================== */

function finalizarEleicaoOficial(){

    db.status.eleicaoAberta = false;
    salvarDB();

    gerarCertificacaoFinal();
    abrirAba("finalizacaoSistema");
}

/* ===========================
   CERTIFICA√á√ÉO FINAL
=========================== */

function gerarCertificacaoFinal(){

    let totalVotos = db.votos.length;
    let totalEleitores = db.eleitores.length;

    let resultadoDeputado = contarVotosPorCargo("deputado");
    let resultadoPresidente = contarVotosPorCargo("presidente");

    let hashFinal = gerarHashVoto({
        eleitorID:"FINAL",
        deputado:JSON.stringify(resultadoDeputado),
        presidente:JSON.stringify(resultadoPresidente),
        timestamp:new Date().toLocaleString()
    });

    document.getElementById("certificadoFinal").innerHTML = `
        <h2>${db.config.nomeEleicao || "Elei√ß√£o Oficial RPG"}</h2>
        <p><strong>Ministro Presidente:</strong> ${db.config.ministro || "---"}</p>
        <p><strong>Total de Eleitores:</strong> ${totalEleitores}</p>
        <p><strong>Total de Votos Apurados:</strong> ${totalVotos}</p>

        <hr>

        <h3>Resultado Deputado</h3>
        <pre>${JSON.stringify(resultadoDeputado,null,2)}</pre>

        <h3>Resultado Presidente</h3>
        <pre>${JSON.stringify(resultadoPresidente,null,2)}</pre>

        <hr>

        <p><strong>Hash Oficial de Encerramento:</strong></p>
        <p>${hashFinal}</p>
    `;

    let integridade = verificarIntegridade();

    document.getElementById("seloIntegridadeFinal").innerHTML = integridade
        ? "‚úî Sistema auditado. Integridade confirmada."
        : "‚ö† Inconsist√™ncia detectada nos registros.";

}

/* ===========================
   EXPORTA√á√ÉO RELAT√ìRIO FINAL
=========================== */

function exportarResultadoFinal(){

    let relatorio = {
        eleicao: db.config.nomeEleicao,
        ministro: db.config.ministro,
        totalEleitores: db.eleitores.length,
        totalVotos: db.votos.length,
        resultadoDeputado: contarVotosPorCargo("deputado"),
        resultadoPresidente: contarVotosPorCargo("presidente"),
        votos: db.votos,
        logs: db.logs
    };

    let dataStr = "data:text/json;charset=utf-8," +
        encodeURIComponent(JSON.stringify(relatorio,null,2));

    let dlAnchor = document.createElement("a");
    dlAnchor.setAttribute("href", dataStr);
    dlAnchor.setAttribute("download", "resultado_oficial_eleicao_rpg.json");
    dlAnchor.click();
}

/* ===========================
   BLOQUEIO TOTAL P√ìS-ENCERRAMENTO
=========================== */

function bloquearSistemaSeEncerrado(){

    if(!db.status.eleicaoAberta){
        document.querySelectorAll("input,button").forEach(el=>{
            if(!el.classList.contains("botao-exportar")){
                el.disabled = true;
            }
        });
    }
}

setInterval(()=>{
    bloquearSistemaSeEncerrado();
},3000);

/* ===========================
   FINALIZA√á√ÉO COMPLETA
=========================== */

function sistemaPronto(){

    atualizarLayoutGlobal();
    sincronizacaoTotalSistema();
    bloquearSistemaSeEncerrado();
}

window.onload = function(){
    inicializarSistema();
    sistemaPronto();
};

</script>